<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
    <script src="../scripts/gameworld.js"></script>
    <script>
        function appendTest(){
            var b = document.getElementsByTagName("body")[0]
            var testElement = document.createElement("div");
            var canvas = document.createElement("canvas");
            testElement.appendChild(canvas);
            b.appendChild(testElement);
            return canvas;
        }
        function createTestTileData(callback){
            loadTileAtlas([
                {
                    "id": 1,
                    "src":"testgrid.png",
                    "nrows": 5,
                    "ncols": 5,
                    "xsize": 56,
                    "ysize": 56 
                }
            ],callback);
        }
        function test1(){

            var displayResult = function (result){
                var testCanvas = appendTest();
                var context = testCanvas.getContext("2d");
                result[1].draw(context,0,0,0,0,40,40);
                result[1].draw(context,0,0,40,0,40,40);
                result[1].draw(context,1,1,0,40,40,40);
                result[1].draw(context,1,0,40,40,40,40);
            }


            //debugger;
            createTestTileData(displayResult);
        }

        function test2(){
            var displayResult = function(result){
                var testCanvas = appendTest();
                
                var gw = new WorldGridLayer(10,10,1)
                gw.update([
                    [0,0,[0,0]],
                    [1,1,[0,1]],
                    [2,2,[0,2]],
                    [3,3,[0,3]],
                    [4,4,[0,4]],
                    [5,5,[1,0]],
                    [6,6,[1,1]],
                    [7,7,[1,2]],
                    [8,8,[1,3]],
                    [9,9,[1,4]] //draws tile(2,2) at position 1,1
                ])

                function mockCanvasView(){
                    this.context = testCanvas.getContext("2d");
                    this.getDrawBounds = function(){
                        return [0,10,0,10];
                    }
                    this.offset_x = 0;
                    this.offset_y = 0;
                }

                function mockWorld(){
                    this.grid_size_x = 25;
                    this.grid_size_y = 25;
                }
                testCanvas.height = 25*10;
                testCanvas.width = 25*10;
                gw.render(
                    new mockCanvasView(),
                    new mockWorld(),
                    result
                )
            }

            createTestTileData(displayResult)
        }
        function run(){
            test2();   
            test1();
             
            
        
        }
        window.onload = run
        </script>
</head>
<body>
    hello
</body>
</html>

